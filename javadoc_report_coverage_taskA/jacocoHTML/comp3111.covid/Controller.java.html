<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Controller.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">deCOVID</a> &gt; <a href="index.source.html" class="el_package">comp3111.covid</a> &gt; <span class="el_source">Controller.java</span></div><h1>Controller.java</h1><pre class="source lang-java linenums">package comp3111.covid;


import java.io.IOException;
import java.net.URL;
import java.util.LinkedList;
import java.util.ResourceBundle;

import org.apache.commons.csv.CSVRecord;


import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.fxml.Initializable;
import javafx.scene.Node;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.CheckMenuItem;
import javafx.scene.control.DatePicker;
import javafx.scene.control.Menu;
import javafx.scene.control.Tab;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.stage.Stage;
/**
 * Building on the sample skeleton for 'ui.fxml' Controller Class generated by SceneBuilder 
 */
<span class="fc" id="L31">public class Controller implements Initializable {</span>
	
<span class="fc" id="L33">	private LinkedList &lt;String&gt; selectedcountryA = new LinkedList&lt;String&gt;();</span>
	
    @FXML
    private Menu countrymenuA1;
	
    @FXML
    private DatePicker dateselectionbeginA2;

    @FXML
    private DatePicker dateselectionendA2;

    @FXML
    private Menu countrymenuA2;

    @FXML
    private Tab tabTaskZero;

    @FXML
    private TextField textfieldISO;

    @FXML
    private Button buttonConfirmedDeaths;

    @FXML
    private TextField textfieldDataset;

    @FXML
    private Button buttonRateOfVaccination;

    @FXML
    private Button buttonConfirmedCases;
    
    @FXML
    private DatePicker dateselectiontaskA;
    
    @FXML
    private Button EnterA1;
    
    @FXML
    private Button EnterA2;
    
    @FXML
    private Tab tabReport1;

    @FXML
    private Tab tabReport2;

    @FXML
    private Tab tabReport3;

    @FXML
    private Tab tabApp1;

    @FXML
    private Tab tabApp2;

    @FXML
    private Tab tabApp3;

    @FXML
    private TextArea textAreaConsole;

    
    /**
     *  Task Zero
     *  To be triggered by the &quot;Confirmed Cases&quot; button on the Task Zero Tab 
     *  
     */
    @FXML
    void doConfirmedCases(ActionEvent event) {
<span class="nc" id="L103">    	String iDataset = textfieldDataset.getText();</span>
<span class="nc" id="L104">    	String iISO = textfieldISO.getText();</span>
<span class="nc" id="L105">    	String oReport = DataAnalysis.getConfirmedCases(iDataset, iISO);</span>
<span class="nc" id="L106">    	textAreaConsole.setText(oReport);</span>
<span class="nc" id="L107">    }</span>

  
    /**
     *  Task Zero
     *  To be triggered by the &quot;Confirmed Deaths&quot; button on the Task Zero Tab
     *  
     */
    @FXML
    void doConfirmedDeaths(ActionEvent event) {
<span class="nc" id="L117">    	String iDataset = textfieldDataset.getText();</span>
<span class="nc" id="L118">    	String iISO = textfieldISO.getText();</span>
<span class="nc" id="L119">    	String oReport = DataAnalysis.getConfirmedDeaths(iDataset, iISO);</span>
<span class="nc" id="L120">    	textAreaConsole.setText(oReport);</span>
<span class="nc" id="L121">    }</span>

  
    /**
     *  Task Zero
     *  To be triggered by the &quot;Rate of Vaccination&quot; button on the Task Zero Tab
     *  
     */
    @FXML
    void doRateOfVaccination(ActionEvent event) {
<span class="nc" id="L131">    	String iDataset = textfieldDataset.getText();</span>
<span class="nc" id="L132">    	String iISO = textfieldISO.getText();</span>
<span class="nc" id="L133">    	String oReport = DataAnalysis.getRateOfVaccination(iDataset, iISO);</span>
<span class="nc" id="L134">    	textAreaConsole.setText(oReport);</span>
<span class="nc" id="L135">    }</span>
    
    
    /**
     *  When this method is called, it will switch scene and pass the date to the TablecontrollerA
     */
    @FXML
    void switchscenetotableA1(ActionEvent event) throws IOException{
<span class="nc" id="L143">    	FXMLLoader tableloader = new FXMLLoader();</span>
<span class="nc" id="L144">    	tableloader.setLocation(getClass().getResource(&quot;/tablegenerator.fxml&quot;));</span>
<span class="nc" id="L145">    	Parent tableviewA = tableloader.load();</span>
<span class="nc" id="L146">    	Scene tableviewscene = new Scene(tableviewA);</span>
    	// access the controller and call a method
<span class="nc" id="L148">    	TablecontrollerA tablecontroller = tableloader.getController();</span>
    	try {
<span class="nc" id="L150">    		selectedcountryA.getFirst();</span>
<span class="nc" id="L151">    		tablecontroller.initData(getdate(dateselectiontaskA),selectedcountryA);</span>
<span class="nc" id="L152">        	Stage tablewindow = (Stage) ((Node)event.getSource()).getScene().getWindow(); </span>
<span class="nc" id="L153">        	tablewindow.setScene(tableviewscene);</span>
<span class="nc" id="L154">        	tablewindow.show();</span>
    	}
<span class="nc" id="L156">    	catch(Exception e) {</span>
<span class="nc" id="L157">    		textAreaConsole.setText(&quot;please select at least one country and enter a specific date&quot;);</span>
<span class="nc" id="L158">    	}</span>
<span class="nc" id="L159">    }</span>
    
    /**
     *  When this method is called, it will switch scene and pass the date to the ChartcontrollerA
     */
    @FXML
    void switchscenetochartA2(ActionEvent event) throws Exception {
<span class="nc" id="L166">    	FXMLLoader chartloader = new FXMLLoader();</span>
<span class="nc" id="L167">    	chartloader.setLocation(getClass().getResource(&quot;/chartgenerator.fxml&quot;));</span>
<span class="nc" id="L168">    	Parent chartviewA = chartloader.load();</span>
<span class="nc" id="L169">    	Scene chartviewscene = new Scene(chartviewA);</span>
    	// access the controller and call a method
<span class="nc" id="L171">    	ChartcontrollerA chartcontroller = chartloader.getController();</span>
    	try{
<span class="nc" id="L173">    		selectedcountryA.getFirst();		</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">    		if(comparedate(dateselectionbeginA2).compareTo(comparedate(dateselectionendA2))&gt;=0) {</span>
<span class="nc" id="L175">        		throw new Exception();</span>
        	}       	
<span class="nc" id="L177">    		chartcontroller.initData(getdate(dateselectionbeginA2), getdate(dateselectionendA2), selectedcountryA);</span>
<span class="nc" id="L178">        	Stage chartwindow = (Stage) ((Node)event.getSource()).getScene().getWindow(); </span>
<span class="nc" id="L179">    		chartwindow.setScene(chartviewscene);</span>
<span class="nc" id="L180">    		chartwindow.show();</span>
    	}
<span class="nc" id="L182">    	catch(Exception e) {</span>
<span class="nc" id="L183">    		textAreaConsole.setText(&quot;please select at least one country and enter the specific date for begin and return&quot;</span>
    				+ &quot;\nor you may check that the beginning date should be in front of end date.&quot;);
<span class="nc" id="L185">    	}</span>
<span class="nc" id="L186">    }</span>
    
   /**
    * transform the date into the format of dataset: MM/DD/YYYY (i.e. 1/3/2021)
    */
    String getdate(DatePicker dateselection) {
<span class="fc" id="L192">    	String date = dateselection.getValue().toString();</span>
<span class="fc" id="L193">    	String year = date.substring(0,4);</span>
<span class="fc" id="L194">	    String month = date.substring(5,7);</span>
<span class="fc bfc" id="L195" title="All 2 branches covered.">	    if (month.charAt(0)=='0')  month = month.substring(1);  // i.e. 01-&gt;1</span>
<span class="fc" id="L196">	    String day = date.substring(8);</span>
<span class="fc bfc" id="L197" title="All 2 branches covered.">	    if (day.charAt(0)=='0')  day = day.substring(1);  // i.e. 01-&gt;1</span>
<span class="fc" id="L198">	    String selecteddate = month+&quot;/&quot;+day+&quot;/&quot;+year; </span>
<span class="fc" id="L199">	    return selecteddate;</span>
    }
    
    /**
     * compare the date between two DatePicker objects
     */
    String comparedate(DatePicker dateselection) {
<span class="nc" id="L206">    	return dateselection.getValue().toString();</span>
    }

    /**
     * initialize the country menu(add all countries which can be selected into the menu)
     */
	@Override
	public void initialize(URL location, ResourceBundle resources) {
<span class="fc" id="L214">		EventHandler &lt;ActionEvent&gt; event = new EventHandler&lt;ActionEvent&gt;() {</span>
			@Override
			public void handle(ActionEvent e) {
<span class="nc bnc" id="L217" title="All 2 branches missed.">				if (((CheckMenuItem)e.getSource()).isSelected()) {</span>
<span class="nc" id="L218">					selectedcountryA.add(((CheckMenuItem)e.getSource()).getText());</span>
				}
				else;
<span class="nc" id="L221">			}			</span>
		};
<span class="fc" id="L223">		String previous_country = &quot;&quot;;</span>
<span class="fc" id="L224">		String current_country = &quot;&quot;;</span>
<span class="fc bfc" id="L225" title="All 2 branches covered.">		for(CSVRecord rec: DataAnalysis.getFileParser(&quot;COVID_Dataset_v1.0.csv&quot;)) {</span>
<span class="fc" id="L226">			current_country = rec.get(&quot;location&quot;);</span>
<span class="fc bfc" id="L227" title="All 2 branches covered.">			if (!current_country.equals(previous_country)){</span>
<span class="fc" id="L228">				CheckMenuItem item1 = new CheckMenuItem(current_country);</span>
<span class="fc" id="L229">				CheckMenuItem item2 = new CheckMenuItem(current_country);</span>
<span class="fc" id="L230">				item1.setOnAction(event);</span>
<span class="fc" id="L231">				item2.setOnAction(event);</span>
<span class="fc" id="L232">				countrymenuA1.getItems().add(item1);</span>
<span class="fc" id="L233">				countrymenuA2.getItems().add(item2);</span>
<span class="fc" id="L234">				previous_country = current_country;</span>
			}
<span class="fc" id="L236">		}</span>
<span class="fc" id="L237">	}</span>
	
	/**
	 * This function is just used for testing whether getdate() can get the proper date.
	 */
	public DatePicker getdatepicker() {
<span class="fc" id="L243">		return dateselectionbeginA2;</span>
	}
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>